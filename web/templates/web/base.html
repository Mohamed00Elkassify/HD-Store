{% load static web_tags %}<!DOCTYPE html>
<html lang="{{ lang }}" dir="{{ dir }}" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}HD Store{% endblock %}</title>
  <meta name="description" content="{% block meta_description %}Premium Imported Laptops Since 2008{% endblock %}">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Narrow:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            navy: '#0e1d2c',
            'brand-blue': '#28598a',
            'brand-light-blue': '#3878bb',
            'brand-gray': '#e9e8e8',
            border: 'var(--border)',
            input: 'var(--input)',
            ring: 'var(--ring)',
            background: 'var(--background)',
            foreground: 'var(--foreground)',
            primary: { DEFAULT: 'var(--primary)', foreground: 'var(--primary-foreground)' },
            secondary: { DEFAULT: 'var(--secondary)', foreground: 'var(--secondary-foreground)' },
            destructive: { DEFAULT: 'var(--destructive)', foreground: '#fff' },
            muted: { DEFAULT: 'var(--muted)', foreground: 'var(--muted-foreground)' },
            accent: { DEFAULT: 'var(--accent)', foreground: 'var(--accent-foreground)' },
            popover: { DEFAULT: 'var(--popover)', foreground: 'var(--popover-foreground)' },
            card: { DEFAULT: 'var(--card)', foreground: 'var(--card-foreground)' },
          },
          fontFamily: {
            heading: ['"Archivo Narrow"', 'system-ui', 'sans-serif'],
            sans: {% if is_rtl %}['"Cairo"', '"Montserrat"', 'system-ui', 'sans-serif']{% else %}['"Montserrat"', '"Cairo"', 'system-ui', 'sans-serif']{% endif %},
          },
          borderRadius: {
            lg: '0.625rem',
            md: '0.425rem',
            sm: '0.225rem',
          },
        },
      },
    }
  </script>

  <!-- Alpine.js + Collapse plugin -->
  <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

  <style>
    :root {
      --radius: 0.625rem;
      --navy: #0e1d2c;
      --brand-blue: #28598a;
      --brand-light-blue: #3878bb;
      --brand-gray: #e9e8e8;
      --background: #ffffff;
      --foreground: #0e1d2c;
      --card: #ffffff;
      --card-foreground: #0e1d2c;
      --popover: #ffffff;
      --popover-foreground: #0e1d2c;
      --primary: #28598a;
      --primary-foreground: #ffffff;
      --secondary: #e9e8e8;
      --secondary-foreground: #0e1d2c;
      --muted: #f5f5f5;
      --muted-foreground: #64748b;
      --accent: #f0f7ff;
      --accent-foreground: #28598a;
      --destructive: #ef4444;
      --border: #e2e8f0;
      --input: #e2e8f0;
      --ring: #3878bb;
    }
    .dark {
      --background: #0a1120;
      --foreground: #f1f5f9;
      --card: #0e1d2c;
      --card-foreground: #f1f5f9;
      --popover: #0e1d2c;
      --popover-foreground: #f1f5f9;
      --primary: #3878bb;
      --primary-foreground: #ffffff;
      --secondary: #1e293b;
      --secondary-foreground: #f1f5f9;
      --muted: #1e293b;
      --muted-foreground: #94a3b8;
      --accent: #162033;
      --accent-foreground: #93c5fd;
      --destructive: #ef4444;
      --border: #1e293b;
      --input: #1e293b;
      --ring: #3878bb;
    }
    * { border-color: var(--border); }
    body { background: var(--background); color: var(--foreground); }
    [dir="rtl"] { text-align: right; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--muted-foreground); border-radius: 3px; }
  </style>

  {% block extra_head %}{% endblock %}
</head>
<body class="min-h-screen font-sans antialiased" x-data="{ darkMode: localStorage.getItem('theme') === 'dark' }" x-init="$watch('darkMode', v => { localStorage.setItem('theme', v ? 'dark' : 'light'); document.documentElement.classList.toggle('dark', v) }); if (darkMode) document.documentElement.classList.add('dark')">

  <div class="flex min-h-screen flex-col">
    {% include "web/partials/_header.html" %}

    <main class="flex-1">
      {% block content %}{% endblock %}
    </main>

    {% include "web/partials/_footer.html" %}
  </div>

  {% include "web/partials/_whatsapp_float.html" %}

  <!-- Toast notifications -->
  <div id="toast-container" class="fixed bottom-4 right-4 z-50 space-y-2" x-data="toastStore()" @show-toast.window="addToast($event.detail)">
    <template x-for="toast in toasts" :key="toast.id">
      <div x-show="toast.visible"
           x-transition:enter="transition ease-out duration-300"
           x-transition:enter-start="opacity-0 translate-y-2"
           x-transition:enter-end="opacity-100 translate-y-0"
           x-transition:leave="transition ease-in duration-200"
           x-transition:leave-start="opacity-100"
           x-transition:leave-end="opacity-0"
           class="rounded-lg bg-card border border-border px-4 py-3 text-sm shadow-lg">
        <span x-text="toast.message"></span>
      </div>
    </template>
  </div>

  <script>
    // Initialize Lucide icons
    document.addEventListener('DOMContentLoaded', () => { lucide.createIcons(); });
    document.addEventListener('alpine:initialized', () => {
      setTimeout(() => lucide.createIcons(), 100);
    });

    // Toast notification system
    function toastStore() {
      return {
        toasts: [],
        addToast(detail) {
          const id = Date.now();
          this.toasts.push({ id, message: detail.message, visible: true });
          setTimeout(() => {
            const t = this.toasts.find(t => t.id === id);
            if (t) t.visible = false;
            setTimeout(() => { this.toasts = this.toasts.filter(t => t.id !== id); }, 300);
          }, 3000);
        }
      }
    }

    function showToast(message) {
      window.dispatchEvent(new CustomEvent('show-toast', { detail: { message } }));
    }

    // CSRF token helper for fetch
    function getCookie(name) {
      let val = null;
      document.cookie.split(';').forEach(c => {
        c = c.trim();
        if (c.startsWith(name + '=')) val = decodeURIComponent(c.substring(name.length + 1));
      });
      return val;
    }
  </script>

  {% block extra_js %}{% endblock %}
</body>
</html>
